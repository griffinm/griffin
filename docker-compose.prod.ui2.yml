name: prod-ui2

networks:
  prod:
    name: prod
    driver: bridge

services:
  api:
    container_name: ui2-api
    image: griffin-api:latest
    build:
      context: .
      dockerfile: Dockerfile.api
    ports:
      - "10101:8080"
    restart: on-failure
    networks:
      - prod
    environment:
      - USE_AWS_SECRETS=false
      - DATABASE_URL=postgresql://griffin:griffin@postgres-prod:5432/budgeting2_production
      - JWT_TOKEN_SECRET=your-secret-jwt-key-change-in-production
      - NODE_ENV=production
      - PORT=8080
      - LOG_LEVEL=log
      - TYPESENSE_HOST=typesense
      - TYPESENSE_PORT=8108
      - TYPESENSE_PROTOCOL=http
      - TYPESENSE_API_KEY=xyz

  ui2:
    container_name: ui2-ui
    image: griffin-ui2:latest
    build:
      context: .
      dockerfile: Dockerfile.ui2
    ports:
      - "10201:8080"
    depends_on:
      - api
    restart: on-failure
    networks:
      - prod
